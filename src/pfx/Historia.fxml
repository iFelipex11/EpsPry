<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.TitledPane?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Pane?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.VBox?>

<BorderPane xmlns="http://javafx.com/javafx/24.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="pfx.HistoriaController">

    <center>
        <TabPane fx:id="tabPane">
            <!-- TAB 1: Historia Clínica -->
            <Tab closable="false" text="Historia Clínica">
                <ScrollPane fitToWidth="true">
                    <VBox spacing="12">
                        <padding><Insets bottom="16" left="16" right="16" top="16" /></padding>

                        <HBox spacing="8">
                            <Label text="Código Paciente:" />
                            <TextField fx:id="txtCodigoPaciente" promptText="(identificación/cédula)" />
                            <Button onAction="#onAbrirHistoria" text="Abrir / Crear historia" />
                        </HBox>

                        <TitledPane expanded="true" text="Datos del Paciente">
                            <content>
                                <GridPane hgap="10" vgap="8">
                                    <padding><Insets bottom="10" left="10" right="10" top="10" /></padding>
                                    <columnConstraints>
                                        <ColumnConstraints halignment="RIGHT" minWidth="120" />
                                        <ColumnConstraints hgrow="ALWAYS" />
                                    </columnConstraints>
                                    <children>
                                        <Label text="Paciente:" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                                        <Label fx:id="lblPaciente" text="—" GridPane.columnIndex="1" GridPane.rowIndex="0" />

                                        <Label text="Historia ID:" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                                        <Label fx:id="lblHistoriaId" text="—" GridPane.columnIndex="1" GridPane.rowIndex="1" />
                                    </children>
                           <rowConstraints>
                              <RowConstraints />
                              <RowConstraints />
                           </rowConstraints>
                                </GridPane>
                            </content>
                        </TitledPane>
                    </VBox>
                </ScrollPane>
            </Tab>

            <!-- TAB 2: Notas de la Historia -->
            <Tab closable="false" text="Notas">
                <BorderPane>
                    <top>
                        <HBox spacing="8">
                            <padding><Insets bottom="10" left="10" right="10" top="10" /></padding>
                            <Label text="Código Paciente:" />
                            <TextField fx:id="txtCodigoPacienteNotas" promptText="(identificación/cédula)" />
                            <Button onAction="#onCargarNotas" text="Cargar" />
                            <Pane HBox.hgrow="ALWAYS" />
                            <Button onAction="#onAgregarNotaCompleta" text="Agregar nota" />
                            <Button onAction="#onRefrescarNotas" text="Refrescar" />
                        </HBox>
                    </top>
                    <center>
                        <TableView fx:id="tblNotas">
                            <columns>
                                <TableColumn fx:id="colFecha" prefWidth="140" text="Creada" />
                                <TableColumn fx:id="colTexto" prefWidth="260" text="Motivo" />
                                <TableColumn fx:id="colAlergias" prefWidth="140" text="Alergias" />
                                <TableColumn fx:id="colMedic" prefWidth="160" text="Medicamentos" />
                                <TableColumn fx:id="colRecom" prefWidth="180" text="Recomendaciones" />
                            </columns>
                        </TableView>
                    </center>
                    <bottom>
                        <HBox spacing="8">
                            <padding><Insets bottom="10" left="10" right="10" top="10" /></padding>
                            <Label text="Historia ID:" />
                            <Label fx:id="lblHistoriaIdNotas" text="—" />
                        </HBox>
                    </bottom>
                </BorderPane>
            </Tab>
        </TabPane>
    </center>
</BorderPane>
